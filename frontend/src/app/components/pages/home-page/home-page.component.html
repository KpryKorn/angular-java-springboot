<section>
  <p>Voici vos tâches pour aujourd'hui :</p>

  <ul class="space-y-2">
    @for (task of tasks(); track task.id) {
    <li
      class="flex items-center gap-3 p-3 bg-white border rounded-lg shadow-sm"
    >
      <input
        type="checkbox"
        [checked]="task.done"
        (change)="toggleTask(task.id)"
        class="w-4 h-4 text-blue-600"
      />

      <span
        [class]="task.done ? 'line-through text-gray-500' : 'text-gray-900'"
      >
        {{ task.title }}
      </span>

      <button
        (click)="deleteTask(task.id)"
        class="ml-auto px-3 py-1 text-sm text-red-600 hover:text-red-800 hover:bg-red-50 rounded"
      >
        Supprimer
      </button>
    </li>
    } @empty {
    <li class="text-center py-8 text-gray-500">Aucune tâche trouvée</li>
    }
  </ul>
</section>

<section>
  <h2 class="mt-8 text-lg font-semibold">Ajouter une nouvelle tâche</h2>

  <form
    [formGroup]="taskForm"
    (ngSubmit)="this.createTask()"
    class="mt-4 space-y-3"
  >
    <div>
      <input
        type="text"
        formControlName="title"
        placeholder="Titre de la tâche"
        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-500"
        [class.border-red-500]="titleControl?.invalid && titleControl?.touched"
      />
      @if (titleControl?.invalid && titleControl?.touched) {
      <p class="text-red-500 text-sm mt-1">
        Le titre est requis (min. 3 caractères)
      </p>
      }
    </div>

    <div>
      <input
        type="text"
        formControlName="description"
        placeholder="Description de la tâche"
        class="w-full p-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 placeholder:text-gray-500"
        [class.border-red-500]="
          descriptionControl?.invalid && descriptionControl?.touched
        "
      />
      @if (descriptionControl?.invalid && descriptionControl?.touched) {
      <p class="text-red-500 text-sm mt-1">
        La description est requise (min. 10 caractères)
      </p>
      }
    </div>

    <button
      type="submit"
      [disabled]="taskForm.invalid"
      class="w-full px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors"
    >
      Ajouter
    </button>
  </form>
</section>
